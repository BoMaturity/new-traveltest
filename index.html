<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Travel Suggestions</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About Us</a>
    <a href="contact.html">Contact Us</a>
  </nav>

  <h1>Welcome to Travel Suggestions</h1>
  <p>Discover your next destination by exploring beautiful beaches, ancient temples, and vibrant countries across Asia.</p>

  <section class="search-box">
    <label for="searchInput"><strong>Search destinations:</strong></label>
    <input type="text" id="searchInput" placeholder="Type to search..." />
    <button id="searchBtn">Search</button>
    <button id="clearBtn">Clear</button>
  </section>

  <section>
    <label for="categorySelect"><strong>Choose category:</strong></label>
    <select id="categorySelect">
      <option value="all">All</option>
      <option value="beaches">Beaches</option>
      <option value="temples">Temples</option>
      <option value="countries">Countries</option>
    </select>
  </section>

  <div class="category-sections" id="categorySections"></div>

  <section id="searchResults" style="display: none;">
    <h2>Search Results</h2>
    <div id="resultsContainer" class="categories"></div>
  </section>

  <h2>Explore Categories</h2>
  <div class="categories">
    <div class="category">
      <a href="beach.html"><img src="images/beach.jpg" alt="Beach" /></a>
      <h3>Beach</h3>
      <p>Relax on beautiful sunny beaches.</p>
    </div>
    <div class="category">
      <a href="temple.html"><img src="images/temple.jpg" alt="Temple" /></a>
      <h3>Temple</h3>
      <p>Discover peaceful and ancient temples.</p>
    </div>
    <div class="category">
      <a href="country.html"><img src="images/country.jpg" alt="Country" /></a>
      <h3>Country</h3>
      <p>Explore vibrant countries and their cultures.</p>
    </div>
  </div>

  <script>
    const categorySelect = document.getElementById("categorySelect");
    const searchInput = document.getElementById("searchInput");
    const searchBtn = document.getElementById("searchBtn");
    const clearBtn = document.getElementById("clearBtn");
    const container = document.getElementById("categorySections");
    const resultsContainer = document.getElementById("resultsContainer");
    const searchResultsSection = document.getElementById("searchResults");

    let data = [];

    fetch("api.json")
      .then(res => res.json())
      .then(json => {
        data = json.destinations;
        renderCategoryBlocks(data);
      });

    function renderCategoryBlocks(list) {
      container.innerHTML = "";
      const grouped = { beaches: [], temples: [], countries: [] };

      list.forEach(item => {
        grouped[item.category].push(item);
      });

      for (const [key, items] of Object.entries(grouped)) {
        if (!items.length) continue;

        const section = document.createElement("section");
        section.className = "category";
        section.id = key;

        const itemNames = items.map(item => `<li>${item.name}</li>`).join("");

        const representativeImage = items[items.length - 1].images[0]; // lấy ảnh đầu của item cuối
        section.innerHTML = `
          <h2>${capitalize(key)}</h2>
          <ul>${itemNames}</ul>
          <img src="${representativeImage}" alt="${key}" class="section-image" />
        `;
        container.appendChild(section);
      }
    }

    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    categorySelect.addEventListener("change", e => {
      const value = e.target.value;
      const filtered = value === "all" ? data : data.filter(item => item.category === value);
      renderCategoryBlocks(filtered);
      searchResultsSection.style.display = "none";
      container.style.display = "block";
    });

    searchBtn.addEventListener("click", () => {
  const query = searchInput.value.toLowerCase().trim();
  if (!query) return;

  const matched = data.filter(item => item.name.toLowerCase().includes(query));
  resultsContainer.innerHTML = "";

  if (matched.length > 0) {
    matched.forEach(item => {
      const div = document.createElement("div");
      div.className = "category";

      const imagesHTML = item.images.map(img => 
        `<img src="${img}" alt="${item.name}" class="section-image" />`
      ).join("");

      div.innerHTML = `
        <h3>${item.name}</h3>
        ${imagesHTML}
        <p>${item.description}</p>
      `;
      resultsContainer.appendChild(div);
    });

    searchResultsSection.style.display = "block";
    container.style.display = "none";
  } else {
    resultsContainer.innerHTML = `<p>No results found.</p>`;
    searchResultsSection.style.display = "block";
    container.style.display = "none";
  }
});

    clearBtn.addEventListener("click", () => {
      searchInput.value = "";
      categorySelect.value = "all";
      renderCategoryBlocks(data);
      searchResultsSection.style.display = "none";
      container.style.display = "block";
    });
  </script>
</body>
</html>
